<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plist → XML Converter</title>
<link rel="icon" href="https://raw.githubusercontent.com/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

body {
    margin: 0;
    font-family: 'Orbitron', sans-serif;
    background: radial-gradient(circle at top, #0a0a1f, #05051a);
    color: #00ffea;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 30px;
    overflow-x: hidden;
}

h1 {
    font-size: 2.5em;
    text-align: center;
    color: #00ffea;
    text-shadow: 0 0 20px #00ffe1, 0 0 40px #00ffe1;
    margin-bottom: 40px;
}

.neon-card {
    background: rgba(0, 0, 0, 0.4);
    border: 2px solid #00ffea;
    border-radius: 20px;
    padding: 20px;
    width: 95%;
    max-width: 1000px;
    box-shadow: 0 0 25px #00ffea, inset 0 0 15px #00ffea;
    backdrop-filter: blur(10px);
    margin-bottom: 30px;
    transition: all 0.3s ease;
}

.neon-card:hover {
    box-shadow: 0 0 50px #00ffea, inset 0 0 25px #00ffea;
}

textarea {
    width: 100%;
    height: 220px;
    background: #111122;
    border: 2px solid #00ffea;
    border-radius: 14px;
    color: #00ffea;
    padding: 15px;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    resize: none;
    box-shadow: 0 0 15px #00ffea;
}

textarea:focus {
    outline: none;
    box-shadow: 0 0 30px #00ffea;
}

button {
    background: linear-gradient(45deg, #00ffea, #004466);
    border: none;
    padding: 14px 30px;
    margin: 10px;
    border-radius: 16px;
    font-weight: bold;
    color: #111122;
    cursor: pointer;
    font-family: 'Orbitron', sans-serif;
    text-transform: uppercase;
    transition: all 0.3s ease;
    box-shadow: 0 0 20px #00ffea, 0 0 30px #00ffea inset;
}

button:hover {
    transform: scale(1.1) rotate(-1deg);
    box-shadow: 0 0 50px #00ffea, 0 0 50px #00ffea inset;
}

pre {
    width: 100%;
    height: 350px;
    background: #111122;
    border: 2px solid #00ffea;
    border-radius: 14px;
    padding: 15px;
    font-size: 14px;
    overflow-y: auto;
    box-shadow: 0 0 25px #00ffea, inset 0 0 20px #00ffea;
    scrollbar-width: thin;
    scrollbar-color: #00ffea #111122;
}

pre::-webkit-scrollbar {
    width: 12px;
}

pre::-webkit-scrollbar-track {
    background: #111122;
}

pre::-webkit-scrollbar-thumb {
    background: #00ffea;
    border-radius: 10px;
}

code {
    display: block;
    white-space: pre-wrap;
}
#backgroundCanvas {
    position: fixed;
    top:0; left:0;
    width: 100%;
    height: 100%;
    z-index: -1;
}
</style>
</head>
<body>

<canvas id="backgroundCanvas"></canvas>

<h1>Plist → XML Converter</h1>

<div class="neon-card">
    <textarea id="inputPlist" placeholder="Paste your .plist content here..."></textarea>
</div>

<div class="neon-card" style="text-align:center;">
    <button onclick="convertPlist()">Convert</button>
    <button onclick="copyOutput()">Copy XML</button>
    <button onclick="downloadXML()">Download XML</button>
</div>

<div class="neon-card">
    <pre><code id="outputXML" class="xml"></code></pre>
</div>

<script>
// Futuristic particle background
const canvas = document.getElementById('backgroundCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];
for (let i = 0; i < 120; i++) {
    particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        r: Math.random() * 2 + 1,
        dx: (Math.random() - 0.5) * 0.5,
        dy: (Math.random() - 0.5) * 0.5
    });
}

function animateParticles() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles.forEach(p => {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(0,255,234,0.7)';
        ctx.fill();
        p.x += p.dx;
        p.y += p.dy;

        if (p.x < 0 || p.x > canvas.width) p.dx *= -1;
        if (p.y < 0 || p.y > canvas.height) p.dy *= -1;
    });
    requestAnimationFrame(animateParticles);
}
animateParticles();

window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
});

// Plist → XML conversion
function convertPlist() {
    const plistText = document.getElementById('inputPlist').value;
    if (!plistText) { alert('Paste your plist first!'); return; }

    const imageMatch = plistText.match(/<key>realTextureFileName<\/key>\s*<string>(.*?)<\/string>/);
    const imageName = imageMatch ? imageMatch[1] : 'PlayerExplosion.png';

    const frameRegex = /<key>(.*?)<\/key>\s*<dict>([\s\S]*?)<\/dict>/g;
    let match;
    let xmlOutput = `<?xml version="1.0" encoding="utf-8"?>\n<TextureAtlas imagePath="${imageName}">\n`;

    while ((match = frameRegex.exec(plistText)) !== null) {
        const frameName = match[1].replace('.png','');
        const dictContent = match[2];

        const rectMatch = dictContent.match(/<key>textureRect<\/key>\s*<string>{{(\d+),(\d+)},{(\d+),(\d+)}}/);
        const sourceMatch = dictContent.match(/<key>spriteSourceSize<\/key>\s*<string>{(\d+),(\d+)}/);

        if (rectMatch && sourceMatch) {
            const x = rectMatch[1];
            const y = rectMatch[2];
            const width = rectMatch[3];
            const height = rectMatch[4];
            const frameWidth = sourceMatch[1];
            const frameHeight = sourceMatch[2];
            const frameX = 0;
            const frameY = 0;

            xmlOutput += `\t<SubTexture name="${frameName}" x="${x}" y="${y}" width="${width}" height="${height}" frameX="${frameX}" frameY="${frameY}" frameWidth="${frameWidth}" frameHeight="${frameHeight}"/>\n`;
        }
    }

    xmlOutput += '</TextureAtlas>';

    const output = document.getElementById('outputXML');
    output.textContent = xmlOutput;
    hljs.highlightElement(output);
}

function copyOutput() {
    const output = document.getElementById('outputXML');
    navigator.clipboard.writeText(output.textContent);
    alert('Copied XML to clipboard!');
}

function downloadXML() {
    const output = document.getElementById('outputXML').textContent;
    const blob = new Blob([output], {type: "text/xml"});
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "converted.xml";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}
</script>

</body>
</html>
